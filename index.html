<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>HyperLang Core Test</title>
</head>
<body>
    <h2>ØªØ³Øª Ù‡Ø³ØªÙ‡ HyperLang</h2>
    <button onclick="runTest()">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</button>
    <div id="result" style="margin-top:20px; padding:10px; border:1px solid #ccc;"></div>
    
    <script type="module">
        async function runTest() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§...<br>';
            
            try {
                // 1. Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ config
                const { CONFIG } = await import('./core/config.js');
                resultDiv.innerHTML += 'âœ… Config loaded<br>';
                
                // 2. Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ context
                const { context } = await import('./core/context.js');
                resultDiv.innerHTML += 'âœ… Context loaded<br>';
                
                // 3. Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ event bus
                const { eventBus } = await import('./core/event-bus.js');
                resultDiv.innerHTML += 'âœ… EventBus loaded<br>';
                
                // 4. Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ contracts
                const { Contracts, validateContract } = await import('./core/contracts.js');
                resultDiv.innerHTML += 'âœ… Contracts loaded<br>';
                
                // 5. Ø«Ø¨Øª Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ Ø¯Ø± context
                context.register('config', CONFIG);
                context.register('eventBus', eventBus);
                
                // 6. ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø·
                eventBus.on('test:success', (data) => {
                    resultDiv.innerHTML += `ğŸ“¢ Event received: ${data.message}<br>`;
                });
                
                eventBus.emit('test:success', { message: 'All systems operational!' });
                
                // 7. ØªØ³Øª context
                const configFromContext = context.get('config');
                if (configFromContext) {
                    resultDiv.innerHTML += `âœ… Config retrieved from context: ${configFromContext.APP_NAME}<br>`;
                }
                
                // Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ
                resultDiv.innerHTML += '<hr><strong style="color:green;">ğŸ‰ Ù‡Ù…Ù‡ Ú†ÛŒØ² Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯! Ø­Ø§Ù„Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ state-manager Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯.</strong>';
                console.log('âœ… All core modules loaded successfully!');
                
            } catch (error) {
                resultDiv.innerHTML += `<span style="color:red;">âŒ Ø®Ø·Ø§: ${error.message}</span><br>`;
                console.error('Test failed:', error);
            }
        }
        
        // Ø®ÙˆØ¯Ú©Ø§Ø± ØªØ³Øª Ù†Ú©Ù†ØŒ Ø¯Ú©Ù…Ù‡ Ø¨Ø²Ù†
        console.log('Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.');
    </script>
</body>
</html>
