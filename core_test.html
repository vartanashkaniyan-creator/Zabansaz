<!DOCTYPE html>
<html dir="rtl">
<head>
    <title>ØªØ³Øª Ù…Ø§Ú˜ÙˆÙ„ Core</title>
    <style>
        body { font-family: Tahoma; margin: 20px; }
        button { padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 5px; margin: 5px; }
        .result { padding: 10px; margin: 5px 0; border-right: 4px solid; }
        .success { background: #E8F5E9; border-color: #4CAF50; }
        .error { background: #FFEBEE; border-color: #F44336; }
    </style>
</head>
<body>
    <h2>âš™ï¸ ØªØ³Øª Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Core</h2>
    <button onclick="testStateManager()">ØªØ³Øª State Manager</button>
    <button onclick="testEventBus()">ØªØ³Øª Event Bus</button>
    <button onclick="testAll()">ØªØ³Øª Ú©Ø§Ù…Ù„ Core</button>
    <div id="results"></div>

    <!-- ÙÙ‚Ø· ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ core -->
    <script src="core/utils.js"></script>
    <script src="core/event_bus.js"></script>
    <script src="core/state.manager.js"></script>
    <script src="core/db.js"></script>
    <script src="core/router.js"></script>

    <script>
        const results = document.getElementById('results');
        
        function showResult(module, message, isSuccess) {
            const div = document.createElement('div');
            div.className = `result ${isSuccess ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${module}:</strong> ${message}`;
            results.appendChild(div);
        }

        function testStateManager() {
            results.innerHTML = '<h3>ğŸ§  ØªØ³Øª State Manager</h3>';
            try {
                if (typeof stateManager === 'undefined') {
                    showResult('state.manager', 'âŒ ÙØ§ÛŒÙ„ Ù„ÙˆØ¯ Ù†Ø´Ø¯', false);
                    return;
                }
                
                showResult('state.manager', 'âœ… ÙØ§ÛŒÙ„ Ù„ÙˆØ¯ Ø´Ø¯', true);
                
                // ØªØ³Øª Ø¹Ù…Ù„ÛŒØ§ØªÛŒ
                stateManager.setState('testKey', 'testValue');
                const retrieved = stateManager.getState('testKey');
                
                if (retrieved === 'testValue') {
                    showResult('state.manager', 'âœ… Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ù…ÙˆÙÙ‚', true);
                } else {
                    showResult('state.manager', `âŒ Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯Ù‡: ${retrieved}`, false);
                }
                
            } catch (error) {
                showResult('state.manager', `âŒ Ø®Ø·Ø§: ${error.message}`, false);
            }
        }

        function testEventBus() {
            results.innerHTML = '<h3>ğŸ“¡ ØªØ³Øª Event Bus</h3>';
            try {
                if (typeof eventBus === 'undefined') {
                    showResult('event_bus', 'âŒ ÙØ§ÛŒÙ„ Ù„ÙˆØ¯ Ù†Ø´Ø¯', false);
                    return;
                }
                
                showResult('event_bus', 'âœ… ÙØ§ÛŒÙ„ Ù„ÙˆØ¯ Ø´Ø¯', true);
                
                // ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯
                let testPassed = false;
                eventBus.on('test-event', (data) => {
                    if (data === 'hello') testPassed = true;
                });
                
                eventBus.emit('test-event', 'hello');
                
                setTimeout(() => {
                    if (testPassed) {
                        showResult('event_bus', 'âœ… Ø§Ø±Ø³Ø§Ù„ Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯ Ù…ÙˆÙÙ‚', true);
                    } else {
                        showResult('event_bus', 'âŒ Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯ Ù†Ø§Ù…ÙˆÙÙ‚', false);
                    }
                }, 100);
                
            } catch (error) {
                showResult('event_bus', `âŒ Ø®Ø·Ø§: ${error.message}`, false);
            }
        }

        function testAll() {
            results.innerHTML = '<h3>ğŸ¯ ØªØ³Øª Ú©Ø§Ù…Ù„ Ù…Ø§Ú˜ÙˆÙ„ Core</h3>';
            testStateManager();
            setTimeout(testEventBus, 200);
            
            // ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ
            setTimeout(() => {
                showResult('Ø³ÛŒØ³ØªÙ…', 'âœ… ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ core ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯', true);
            }, 300);
        }
    </script>
</body>
</html>
