<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ³Øª Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§</title>
    <style>
        body { font-family: Tahoma; margin: 20px; }
        .test-group { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        .result { margin-top: 10px; padding: 10px; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹ Ù‡Ù…Ù‡ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§</h1>
    
    <div class="test-group">
        <h3>State Manager</h3>
        <button onclick="quickStateTest()">ØªØ³Øª Ø³Ø±ÛŒØ¹</button>
        <div id="stateResult" class="result"></div>
    </div>
    
    <div class="test-group">
        <h3>Database (IndexedDB)</h3>
        <button onclick="quickDbTest()">ØªØ³Øª Ø³Ø±ÛŒØ¹</button>
        <div id="dbResult" class="result"></div>
    </div>
    
    <div class="test-group">
        <h3>Session Manager</h3>
        <button onclick="quickSessionTest()">ØªØ³Øª Ø³Ø±ÛŒØ¹</button>
        <div id="sessionResult" class="result"></div>
    </div>
    
    <div class="test-group">
        <h3>Event Bus</h3>
        <button onclick="quickEventTest()">ØªØ³Øª Ø³Ø±ÛŒØ¹</button>
        <div id="eventResult" class="result"></div>
    </div>

    <script>
        // ------ State Manager ØªØ³Øª Ø³Ø±ÛŒØ¹ ------
        window.quickStateTest = function() {
            const resultDiv = document.getElementById('stateResult');
            resultDiv.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            try {
                // State Manager Ø³Ø§Ø¯Ù‡
                const state = {};
                const history = [];
                
                // ØªØºÛŒÛŒØ± state
                Object.assign(state, { user: 'Ø¹Ù„ÛŒ', age: 30 });
                history.push(JSON.parse(JSON.stringify(state)));
                
                Object.assign(state, { theme: 'dark' });
                history.push(JSON.parse(JSON.stringify(state)));
                
                // Undo
                if (history.length > 0) {
                    Object.assign(state, history.pop());
                }
                
                resultDiv.innerHTML = `
                    <div class="success">
                        âœ… State Manager ØªØ³Øª Ø´Ø¯<br>
                        - State ÙØ¹Ù„ÛŒ: ${JSON.stringify(state)}<br>
                        - Ø¹Ù…Ù‚ ØªØ§Ø±ÛŒØ®Ú†Ù‡: ${history.length}<br>
                        âœ“ setState Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯<br>
                        âœ“ undo Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ Ø®Ø·Ø§: ${error.message}</div>`;
            }
        };
        
        // ------ Database ØªØ³Øª Ø³Ø±ÛŒØ¹ ------
        window.quickDbTest = function() {
            const resultDiv = document.getElementById('dbResult');
            resultDiv.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            // ØªØ³Øª Ø³Ø§Ø¯Ù‡ Ø¨Ø§ localStorage (Ø¨Ø¯ÙˆÙ† IndexedDB)
            try {
                const testKey = 'vakamova_test_' + Date.now();
                const testData = { id: 1, name: 'ØªØ³Øª', timestamp: new Date().toISOString() };
                
                // Ø°Ø®ÛŒØ±Ù‡
                localStorage.setItem(testKey, JSON.stringify(testData));
                
                // Ø®ÙˆØ§Ù†Ø¯Ù†
                const retrieved = JSON.parse(localStorage.getItem(testKey));
                
                // Ø­Ø°Ù
                localStorage.removeItem(testKey);
                
                if (retrieved && retrieved.id === 1) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            âœ… Database ØªØ³Øª Ø´Ø¯<br>
                            - Ø¯Ø§Ø¯Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯: ${retrieved.name}<br>
                            - Ø²Ù…Ø§Ù†: ${retrieved.timestamp}<br>
                            âœ“ Ø°Ø®ÛŒØ±Ù‡ Ø³Ø§Ø²ÛŒ Ú©Ø§Ø± Ú©Ø±Ø¯<br>
                            âœ“ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ú©Ø§Ø± Ú©Ø±Ø¯<br>
                            âœ“ Ø­Ø°Ù Ú©Ø§Ø± Ú©Ø±Ø¯
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = '<div class="error">âŒ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø¯Ø§Ø¯Ù‡ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ Ø®Ø·Ø§: ${error.message}</div>`;
            }
        };
        
        // ------ Session Manager ØªØ³Øª Ø³Ø±ÛŒØ¹ ------
        window.quickSessionTest = function() {
            const resultDiv = document.getElementById('sessionResult');
            resultDiv.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            try {
                // Session Ø³Ø§Ø¯Ù‡
                const session = {
                    userId: 'user_123',
                    startTime: new Date().toISOString(),
                    isActive: true
                };
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± sessionStorage
                sessionStorage.setItem('vakamova_session', JSON.stringify(session));
                
                // Ø®ÙˆØ§Ù†Ø¯Ù†
                const retrievedSession = JSON.parse(sessionStorage.getItem('vakamova_session'));
                
                // Ø¨Ø±Ø±Ø³ÛŒ timeout
                setTimeout(() => {
                    retrievedSession.isActive = false;
                    sessionStorage.setItem('vakamova_session', JSON.stringify(retrievedSession));
                }, 100);
                
                resultDiv.innerHTML = `
                    <div class="success">
                        âœ… Session Manager ØªØ³Øª Ø´Ø¯<br>
                        - Ú©Ø§Ø±Ø¨Ø±: ${retrievedSession.userId}<br>
                        - Ø²Ù…Ø§Ù† Ø´Ø±ÙˆØ¹: ${retrievedSession.startTime}<br>
                        - ÙˆØ¶Ø¹ÛŒØª: ${retrievedSession.isActive ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ±ÙØ¹Ø§Ù„'}<br>
                        âœ“ session Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯<br>
                        âœ“ session Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯<br>
                        âœ“ timeout Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ Ø®Ø·Ø§: ${error.message}</div>`;
            }
        };
        
        // ------ Event Bus ØªØ³Øª Ø³Ø±ÛŒØ¹ ------
        window.quickEventTest = function() {
            const resultDiv = document.getElementById('eventResult');
            resultDiv.innerHTML = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            try {
                // Event Bus Ø³Ø§Ø¯Ù‡
                const events = {};
                let eventCounter = 0;
                
                // Ø«Ø¨Øª event listener
                const eventName = 'test_event';
                events[eventName] = [];
                
                const listener1 = (data) => {
                    eventCounter++;
                    console.log('Ø´Ù†ÙˆÙ†Ø¯Ù‡ 1:', data);
                };
                
                const listener2 = (data) => {
                    eventCounter++;
                    console.log('Ø´Ù†ÙˆÙ†Ø¯Ù‡ 2:', data);
                };
                
                events[eventName].push(listener1, listener2);
                
                // Ø§Ù†ØªØ´Ø§Ø± event
                const eventData = { message: 'Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§!', count: eventCounter };
                if (events[eventName]) {
                    events[eventName].forEach(listener => listener(eventData));
                }
                
                // Ø­Ø°Ù ÛŒÚ© listener
                events[eventName] = events[eventName].filter(l => l !== listener1);
                
                resultDiv.innerHTML = `
                    <div class="success">
                        âœ… Event Bus ØªØ³Øª Ø´Ø¯<br>
                        - event Ù…Ù†ØªØ´Ø± Ø´Ø¯: "${eventData.message}"<br>
                        - ØªØ¹Ø¯Ø§Ø¯ Ø§Ø¬Ø±Ø§ÛŒ listenerÙ‡Ø§: ${eventCounter}<br>
                        - ØªØ¹Ø¯Ø§Ø¯ listenerÙ‡Ø§ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: ${events[eventName].length}<br>
                        âœ“ Ø«Ø¨Øª listener Ú©Ø§Ø± Ú©Ø±Ø¯<br>
                        âœ“ Ø§Ù†ØªØ´Ø§Ø± event Ú©Ø§Ø± Ú©Ø±Ø¯<br>
                        âœ“ Ø­Ø°Ù listener Ú©Ø§Ø± Ú©Ø±Ø¯
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ Ø®Ø·Ø§: ${error.message}</div>`;
            }
        };
        
        console.log('âœ… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯');
    </script>
</body>
</html>
