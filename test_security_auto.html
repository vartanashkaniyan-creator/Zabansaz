<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <title>ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</title>
    <style>
        body { font-family: Tahoma; padding: 20px; background: #f5f5f5; }
        .result { padding: 15px; margin: 10px 0; border-radius: 8px; border-right: 5px solid; }
        .success { background: #e8f5e9; border-color: #4caf50; color: #2e7d32; }
        .error { background: #ffebee; border-color: #f44336; color: #c62828; }
        .loading { background: #fff3e0; border-color: #ff9800; color: #ef6c00; }
        .security-badge { display: inline-block; padding: 5px 10px; margin: 5px; border-radius: 4px; font-weight: bold; }
    </style>
</head>
<body>
    <h2>ğŸ” ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Vakamova</h2>
    <div id="status" class="result loading">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ùˆ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ...</div>
    <div id="results"></div>

    <script>
        // ğŸ”¹ ÙÙˆØ±Ø§Ù‹ Ø¨Ø¹Ø¯ Ø§Ø² Ù„ÙˆØ¯ Ø´Ø¯Ù† DOM Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯
        document.addEventListener('DOMContentLoaded', function() {
            runSecurityTests();
        });

        // ğŸ”¹ Ù‡Ù…Ú†Ù†ÛŒÙ† Ø¨Ø§ ØªØ§Ø®ÛŒØ± 500ms Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù†
        setTimeout(runSecurityTests, 500);

        async function runSecurityTests() {
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            try {
                // ØªØ³Øª 1: Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ localStorage
                statusDiv.innerHTML = 'ğŸ” Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ localStorage...';
                const localStorageTest = testLocalStorage();
                
                // ØªØ³Øª 2: Ø¨Ø±Ø±Ø³ÛŒ XSS Protection
                statusDiv.innerHTML = 'ğŸ›¡ï¸ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­Ø§ÙØ¸Øª XSS...';
                const xssTest = testXSSProtection();
                
                // ØªØ³Øª 3: Ø¨Ø±Ø±Ø³ÛŒ ØªÙˆÚ©Ù† Ø§Ù…Ù†ÛŒØªÛŒ
                statusDiv.innerHTML = 'ğŸ”‘ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù…Ù†ÛŒØª ØªÙˆÚ©Ù†...';
                const tokenTest = testTokenSecurity();
                
                // ØªØ³Øª 4: Ø¨Ø±Ø±Ø³ÛŒ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ
                statusDiv.innerHTML = 'ğŸ”’ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ...';
                const encryptionTest = testEncryption();
                
                // ØªØ³Øª 5: Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
                statusDiv.innerHTML = 'ğŸ“ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ...';
                const validationTest = testInputValidation();
                
                // Ø¬Ù…Ø¹â€ŒØ¨Ù†Ø¯ÛŒ Ù†ØªØ§ÛŒØ¬
                const allTests = [
                    { name: 'Ø§Ù…Ù†ÛŒØª localStorage', result: localStorageTest },
                    { name: 'Ù…Ø­Ø§ÙØ¸Øª Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± XSS', result: xssTest },
                    { name: 'Ø§Ù…Ù†ÛŒØª ØªÙˆÚ©Ù†â€ŒÙ‡Ø§', result: tokenTest },
                    { name: 'Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§', result: encryptionTest },
                    { name: 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ', result: validationTest }
                ];
                
                const passedTests = allTests.filter(t => t.result.passed).length;
                const totalTests = allTests.length;
                
                // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
                resultsDiv.innerHTML = `
                    <div class="result ${passedTests === totalTests ? 'success' : 'error'}">
                        <h3>ğŸ“Š Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ</h3>
                        <p>${passedTests} Ø§Ø² ${totalTests} ØªØ³Øª Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯</p>
                        <p>Ø§Ù…ØªÛŒØ§Ø² Ø§Ù…Ù†ÛŒØªÛŒ: ${Math.round((passedTests/totalTests)*100)}/100</p>
                    </div>
                `;
                
                // Ù†Ù…Ø§ÛŒØ´ Ø¬Ø²ÛŒÛŒØ§Øª Ù‡Ø± ØªØ³Øª
                allTests.forEach(test => {
                    resultsDiv.innerHTML += `
                        <div class="result ${test.result.passed ? 'success' : 'error'}">
                            <strong>${test.result.passed ? 'âœ…' : 'âŒ'} ${test.name}</strong>
                            <p>${test.result.message}</p>
                            ${test.result.details ? `<small>${test.result.details}</small>` : ''}
                        </div>
                    `;
                });
                
                statusDiv.className = passedTests === totalTests ? 'result success' : 'result error';
                statusDiv.innerHTML = passedTests === totalTests ? 
                    'âœ… ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú¯Ø°Ø´ØªÙ†Ø¯' :
                    'âš ï¸ Ø¨Ø±Ø®ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙˆØ¬Ù‡ Ø¯Ø§Ø±Ù†Ø¯';
                    
            } catch (error) {
                statusDiv.className = 'result error';
                statusDiv.innerHTML = `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª: ${error.message}`;
                resultsDiv.innerHTML = `<div class="error">Ø®Ø·Ø§ÛŒ ÙÙ†ÛŒ: ${error.toString()}</div>`;
                console.error('Ø®Ø·Ø§ÛŒ ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ:', error);
            }
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ ØªØ³Øª ====================
        
        function testLocalStorage() {
            try {
                // ØªØ³Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ localStorage
                const testKey = 'security_test_' + Date.now();
                const testValue = 'test_data';
                
                localStorage.setItem(testKey, testValue);
                const retrieved = localStorage.getItem(testKey);
                localStorage.removeItem(testKey);
                
                const passed = retrieved === testValue;
                
                return {
                    passed,
                    message: passed ? 'localStorage Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ùˆ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯' : 'Ù…Ø´Ú©Ù„ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ localStorage',
                    details: passed ? null : 'Ù…Ø±ÙˆØ±Ú¯Ø± Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø­Ø§Ù„Øª Ø®ØµÙˆØµÛŒ Ø¨Ø§Ø´Ø¯ ÛŒØ§ localStorage ØºÛŒØ±ÙØ¹Ø§Ù„ Ø§Ø³Øª'
                };
            } catch (error) {
                return {
                    passed: false,
                    message: 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ localStorage',
                    details: error.message
                };
            }
        }
        
        function testXSSProtection() {
            // ØªØ³Øª Ù…Ø­Ø§ÙØ¸Øª Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± XSS
            const xssPayloads = [
                '<script>alert(1)</script>',
                '<img src=x onerror=alert(1)>',
                'javascript:alert(1)',
                'eval("alert(1)")'
            ];
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø§Ø¯Ù‡â€ŒØªØ±ÛŒÙ† Ù…Ø­Ø§ÙØ¸Øª
            const testString = xssPayloads[0];
            const sanitized = testString.replace(/[<>]/g, '');
            
            const passed = !sanitized.includes('<script>');
            
            return {
                passed,
                message: passed ? 'Ù…Ø­Ø§ÙØ¸Øª Ø§ÙˆÙ„ÛŒÙ‡ XSS ÙØ¹Ø§Ù„ Ø§Ø³Øª' : 'Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…Ø­Ø§ÙØ¸Øª Ø¨Ù‡ØªØ± Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± XSS',
                details: passed ? null : 'Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ < Ùˆ > Ø¨Ø§ÛŒØ¯ Ø³Ø§Ù†ÛŒâ€ŒØªØ§ÛŒØ² Ø´ÙˆÙ†Ø¯'
            };
        }
        
        function testTokenSecurity() {
            // ØªØ³Øª Ø³Ø§Ø®ØªØ§Ø± ØªÙˆÚ©Ù† Ø§Ù…Ù†
            const validToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c';
            const invalidToken = 'simple_token_123';
            
            const isValid = validToken.split('.').length === 3;
            const isInvalid = invalidToken.split('.').length !== 3;
            
            const passed = isValid && isInvalid;
            
            return {
                passed,
                message: passed ? 'Ø³Ø§Ø®ØªØ§Ø± ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ Ø§Ù…Ù† Ø§Ø³Øª' : 'Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯ Ø³Ø§Ø®ØªØ§Ø± ØªÙˆÚ©Ù†â€ŒÙ‡Ø§',
                details: passed ? null : 'ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ù†ÙˆØ¹ JWT ÛŒØ§ Ø³Ø§Ø®ØªØ§Ø± Ù…Ø´Ø§Ø¨Ù‡ Ø§Ù…Ù† Ø¨Ø§Ø´Ù†Ø¯'
            };
        }
        
        function testEncryption() {
            // ØªØ³Øª Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ù¾Ø§ÛŒÙ‡
            const plainText = 'Ø³Ø±ÛŒØª Ø±Ùˆ Ù…Ø®ÙÛŒ Ú©Ù†';
            
            try {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø³Ø§Ø¯Ù‡
                const encoded = btoa(unescape(encodeURIComponent(plainText)));
                const decoded = decodeURIComponent(escape(atob(encoded)));
                
                const passed = decoded === plainText && encoded !== plainText;
                
                return {
                    passed,
                    message: passed ? 'Ù‚Ø§Ø¨Ù„ÛŒØª Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ/Ø±Ù…Ø²Ú¯Ø´Ø§ÛŒÛŒ ÙØ¹Ø§Ù„ Ø§Ø³Øª' : 'Ù…Ø´Ú©Ù„ Ø¯Ø± Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§',
                    details: passed ? 'Base64 encoding Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯' : 'Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ù‚ÙˆÛŒâ€ŒØªØ±'
                };
            } catch (error) {
                return {
                    passed: false,
                    message: 'Ø®Ø·Ø§ Ø¯Ø± ÙØ±Ø¢ÛŒÙ†Ø¯ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ',
                    details: error.message
                };
            }
        }
        
        function testInputValidation() {
            // ØªØ³Øª Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ
            const testCases = [
                { input: 'test@example.com', type: 'email', shouldPass: true },
                { input: 'invalid-email', type: 'email', shouldPass: false },
                { input: '09123456789', type: 'phone', shouldPass: true },
                { input: '123', type: 'phone', shouldPass: false },
                { input: 'normal_text', type: 'text', shouldPass: true }
            ];
            
            let passedCount = 0;
            const details = [];
            
            testCases.forEach(test => {
                let isValid = false;
                
                if (test.type === 'email') {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    isValid = emailRegex.test(test.input);
                } else if (test.type === 'phone') {
                    isValid = test.input.length >= 10 && /^\d+$/.test(test.input);
                } else {
                    isValid = test.input.length > 0;
                }
                
                if (isValid === test.shouldPass) {
                    passedCount++;
                } else {
                    details.push(`${test.type}: ${test.input} (Ø§Ù†ØªØ¸Ø§Ø±: ${test.shouldPass}, ÙˆØ§Ù‚Ø¹ÛŒØª: ${isValid})`);
                }
            });
            
            const passed = passedCount === testCases.length;
            
            return {
                passed,
                message: passed ? 'Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ ØµØ­ÛŒØ­ Ø§Ø³Øª' : 'Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒ',
                details: passed ? null : details.join(' | ')
            };
        }
        
        // ğŸ”¹ Ù‡Ù…Ú†Ù†ÛŒÙ† Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ
        resultsDiv.innerHTML = `
            <div class="result loading">
                <h3>ğŸ”§ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ØªØ³Øª Ø§Ù…Ù†ÛŒØªÛŒ</h3>
                <p>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù…Ù†ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Vakamova...</p>
                <ul>
                    <li>Ø¨Ø±Ø±Ø³ÛŒ localStorage Ùˆ sessionStorage</li>
                    <li>Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­Ø§ÙØ¸Øª XSS</li>
                    <li>Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù…Ù†ÛŒØª ØªÙˆÚ©Ù†â€ŒÙ‡Ø§</li>
                    <li>Ø¨Ø±Ø±Ø³ÛŒ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</li>
                    <li>Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§</li>
                </ul>
            </div>
        `;
    </script>
</body>
</html>
