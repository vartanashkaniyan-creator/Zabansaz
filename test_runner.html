
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”¬ ØªØ³ØªØ± Ú©Ø§Ù…Ù„ Vakamova</title>
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ (Ù‡Ù…Ø§Ù†) */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #e6e6e6; min-height: 100vh; padding: 20px; line-height: 1.6; }
        .container { max-width: 1400px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 40px; padding: 30px; background: rgba(255, 255, 255, 0.05); border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.1); }
        h1 { color: #64ffda; font-size: 2.8rem; margin-bottom: 10px; }
        .subtitle { color: #8892b0; font-size: 1.2rem; }
        
        .test-section { background: rgba(17, 34, 64, 0.7); border-radius: 15px; padding: 25px; margin-bottom: 25px; border: 1px solid rgba(100, 255, 218, 0.2); }
        .test-title { color: #64ffda; font-size: 1.5rem; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .test-title::before { content: 'ğŸ§ª'; }
        
        .file-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 12px; margin: 20px 0; }
        .file-card { background: rgba(255, 255, 255, 0.05); padding: 12px; border-radius: 8px; text-align: center; border: 1px solid transparent; }
        .file-card.loaded { border-color: #4CAF50; background: rgba(76, 175, 80, 0.1); }
        .file-card.error { border-color: #ff5252; background: rgba(255, 82, 82, 0.1); }
        .file-card .file-name { font-size: 0.85rem; margin-bottom: 5px; }
        .file-card .file-type { font-size: 0.75rem; color: #8892b0; margin-bottom: 5px; }
        .file-card .status { font-size: 0.8rem; font-weight: bold; }
        .file-card.loaded .status { color: #4CAF50; }
        .file-card.error .status { color: #ff5252; }
        
        .control-panel { display: flex; gap: 12px; margin: 25px 0; flex-wrap: wrap; }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-primary { background: linear-gradient(135deg, #0d7377 0%, #14ffec 100%); color: #000; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 12px rgba(13, 115, 119, 0.4); }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255, 255, 255, 0.2); }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); }
        
        .log-container { background: rgba(0, 0, 0, 0.5); border-radius: 10px; padding: 15px; margin-top: 20px; max-height: 500px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.9rem; }
        .log-entry { padding: 8px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .log-entry.success { color: #4CAF50; border-left: 4px solid #4CAF50; padding-left: 12px; }
        .log-entry.error { color: #ff5252; border-left: 4px solid #ff5252; padding-left: 12px; }
        .log-entry.info { color: #64b5f6; border-left: 4px solid #64b5f6; padding-left: 12px; }
        .log-entry.warn { color: #ffb74d; border-left: 4px solid #ffb74d; padding-left: 12px; }
        
        .progress-bar { width: 100%; height: 6px; background: rgba(255, 255, 255, 0.1); border-radius: 3px; margin: 15px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #0d7377, #14ffec); width: 0%; transition: width 0.5s ease; }
        
        .summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-top: 25px; }
        .summary-card { background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 8px; text-align: center; }
        .summary-card h3 { color: #8892b0; margin-bottom: 8px; font-size: 0.9rem; }
        .summary-card .value { font-size: 2rem; font-weight: bold; }
        .summary-card.passed .value { color: #4CAF50; }
        .summary-card.failed .value { color: #ff5252; }
        
        .tab-container { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 10px; }
        .tab { padding: 10px 20px; background: rgba(255, 255, 255, 0.05); border-radius: 6px; cursor: pointer; transition: all 0.3s; }
        .tab.active { background: rgba(100, 255, 218, 0.2); color: #64ffda; }
        .tab:hover { background: rgba(255, 255, 255, 0.1); }
        
        @media (max-width: 768px) {
            .file-list { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
            .control-panel { flex-direction: column; }
            .btn { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”¬ ØªØ³ØªØ± Ú©Ø§Ù…Ù„ Vakamova</h1>
            <p class="subtitle">Ø¢Ø²Ù…Ø§ÛŒØ´ Û±Û¸ ÙØ§ÛŒÙ„ Ù‡Ø³ØªÙ‡ + Ù…Ø§Ú˜ÙˆÙ„ Auth</p>
        </header>
        
        <div class="tab-container">
            <div class="tab active" onclick="showTab('core')">Ù‡Ø³ØªÙ‡ Ø§ØµÙ„ÛŒ</div>
            <div class="tab" onclick="showTab('auth')">Ù…Ø§Ú˜ÙˆÙ„ Auth</div>
            <div class="tab" onclick="showTab('integration')">ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡</div>
        </div>
        
        <div class="test-section" id="coreTab">
            <h2 class="test-title">ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‡Ø³ØªÙ‡ Ùˆ Ù¾Ø§ÛŒÙ‡</h2>
            <div class="file-list" id="coreFileList"></div>
        </div>
        
        <div class="test-section" id="authTab" style="display: none;">
            <h2 class="test-title">Ù…Ø§Ú˜ÙˆÙ„ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª (Auth)</h2>
            <div class="file-list" id="authFileList"></div>
            <div class="control-panel">
                <button class="btn btn-primary" onclick="runAuthTests()">
                    <span>ğŸ” Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Auth</span>
                </button>
                <button class="btn btn-secondary" onclick="testUserFlow()">
                    <span>ğŸ‘¤ ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ø±Ø¨Ø±</span>
                </button>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="control-panel">
            <button class="btn btn-primary" onclick="loadAllFiles()">
                <span>ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‡Ù…Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ (Û±Û¸ ÙØ§ÛŒÙ„)</span>
            </button>
            <button class="btn btn-secondary" onclick="runBasicTests()">
                <span>âš¡ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡</span>
            </button>
            <button class="btn btn-secondary" onclick="runIntegrationTests()">
                <span>ğŸ”— ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· ÙØ§ÛŒÙ„â€ŒÙ‡Ø§</span>
            </button>
            <button class="btn btn-secondary" onclick="clearLogs()">
                <span>ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù„Ø§Ú¯â€ŒÙ‡Ø§</span>
            </button>
        </div>
        
        <div class="summary" id="summarySection">
            <div class="summary-card passed">
                <h3>ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡</h3>
                <div class="value" id="loadedCount">0</div>
            </div>
            <div class="summary-card passed">
                <h3>ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚</h3>
                <div class="value" id="passedCount">0</div>
            </div>
            <div class="summary-card failed">
                <h3>ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚</h3>
                <div class="value" id="failedCount">0</div>
            </div>
            <div class="summary-card">
                <h3>Ú©Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</h3>
                <div class="value" id="totalTests">0</div>
            </div>
        </div>
        
        <div class="test-section">
            <h2 class="test-title">ğŸ“‹ Ú¯Ø²Ø§Ø±Ø´ Ø§Ø¬Ø±Ø§</h2>
            <div class="log-container" id="logContainer"></div>
        </div>
    </div>
    
    <script>
        // ==================== CONFIGURATION ====================
        const CORE_FILES = [
            // ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‡Ø³ØªÙ‡ Ø§ØµÙ„ÛŒ
            { name: 'event_bus.js', path: 'core/event_bus.js', type: 'core', category: 'core' },
            { name: 'context_provider.js', path: 'core/context_provider.js', type: 'core', category: 'core' },
            { name: 'state_manager.js', path: 'core/state_manager.js', type: 'core', category: 'core' },
            { name: 'api_client.js', path: 'core/api_client.js', type: 'core', category: 'core' },
            
            // ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡ Ø§ÙˆÙ„ÛŒÙ‡
            { name: 'state.js', path: 'core/state.js', type: 'base', category: 'core' },
            { name: 'router.js', path: 'core/router.js', type: 'base', category: 'core' },
            { name: 'database.js', path: 'core/database.js', type: 'base', category: 'core' },
            { name: 'api.js', path: 'core/api.js', type: 'base', category: 'core' },
            { name: 'utils.js', path: 'core/utils.js', type: 'base', category: 'core' },
            { name: 'config.js', path: 'core/config.js', type: 'base', category: 'core' },
            
            // ========== Ù…Ø§Ú˜ÙˆÙ„ Auth ==========
            { name: 'auth_utils.js', path: 'modules/auth/auth_utils.js', type: 'auth', category: 'auth' },
            { name: 'auth_validator.js', path: 'modules/auth/auth_validator.js', type: 'auth', category: 'auth' },
            { name: 'token_manager.js', path: 'modules/auth/token_manager.js', type: 'auth', category: 'auth' },
            { name: 'session_service.js', path: 'modules/auth/session_service.js', type: 'auth', category: 'auth' },
            { name: 'permission_checker.js', path: 'modules/auth/permission_checker.js', type: 'auth', category: 'auth' },
            { name: 'auth_analytics.js', path: 'modules/auth/auth_analytics.js', type: 'auth', category: 'auth' },
            { name: 'auth_manager.js', path: 'modules/auth/auth_manager.js', type: 'auth', category: 'auth' },
            { name: 'auth_middleware.js', path: 'modules/auth/auth_middleware.js', type: 'auth', category: 'auth' }
        ];
        
        // ==================== STATE MANAGEMENT ====================
        const appState = {
            loadedFiles: new Set(),
            testResults: { passed: 0, failed: 0, total: 0 },
            logs: [],
            authInstance: null,
            stateInstance: null
        };
        
        // ==================== UI FUNCTIONS ====================
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.test-section').forEach(s => s.style.display = 'none');
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').style.display = 'block';
        }
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            const logEntry = { message, type, timestamp };
            appState.logs.push(logEntry);
            
            const logElement = document.createElement('div');
            logElement.className = `log-entry ${type}`;
            logElement.innerHTML = `<strong>[${timestamp}]</strong> <span>${message}</span>`;
            
            document.getElementById('logContainer').prepend(logElement);
            console.log(`[${type.toUpperCase()}] ${message}`);
            updateSummary();
        }
        
        // ==================== FILE LOADER ====================
        async function loadFile(fileInfo) {
            return new Promise((resolve, reject) => {
                if (appState.loadedFiles.has(fileInfo.name)) {
                    resolve(fileInfo.name);
                    return;
                }
                
                const script = document.createElement('script');
                script.src = fileInfo.path;
                script.type = 'module';
                
                script.onload = () => {
                    appState.loadedFiles.add(fileInfo.name);
                    updateFileCard(fileInfo.name, 'loaded');
                    log(`âœ… ${fileInfo.name} Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯`, 'success');
                    updateProgress();
                    resolve(fileInfo.name);
                };
                
                script.onerror = () => {
                    updateFileCard(fileInfo.name, 'error');
                    log(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ${fileInfo.name}`, 'error');
                    reject(new Error(`Failed to load ${fileInfo.name}`));
                };
                
                document.head.appendChild(script);
            });
        }
        
        async function loadAllFiles() {
            log('ğŸš€ Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Û±Û¸ ÙØ§ÛŒÙ„...', 'info');
            document.getElementById('progressFill').style.width = '0%';
            
            for (let i = 0; i < CORE_FILES.length; i++) {
                const file = CORE_FILES[i];
                try {
                    await loadFile(file);
                    await new Promise(resolve => setTimeout(resolve, 50));
                } catch (error) {
                    log(`Ø®Ø·Ø§: ${error.message}`, 'error');
                }
            }
            
            log('ğŸ‰ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ù…Ù„ Ø´Ø¯!', 'success');
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ø² Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
            if (typeof eventBus !== 'undefined' && typeof HyperStateManager !== 'undefined') {
                appState.stateInstance = new HyperStateManager(eventBus);
                log('âœ… StateManager Ù†Ù…ÙˆÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯', 'success');
            }
        }
        
        // ==================== TEST FUNCTIONS ====================
        async function runBasicTests() {
            log('ğŸ§ª Ø´Ø±ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡ Ù‡Ø³ØªÙ‡...', 'info');
            appState.testResults = { passed: 0, failed: 0, total: 0 };
            
            // ØªØ³Øª EventBus
            if (typeof eventBus !== 'undefined') {
                try {
                    eventBus.emit('core:test', { test: 'data' });
                    log('âœ… EventBus ÙØ¹Ø§Ù„ Ø§Ø³Øª', 'success');
                    appState.testResults.passed++;
                } catch (e) {
                    log(`âŒ EventBus Ø®Ø·Ø§: ${e.message}`, 'error');
                    appState.testResults.failed++;
                }
            }
            
            // ØªØ³Øª StateManager
            if (appState.stateInstance) {
                try {
                    appState.stateInstance.set('test.key', 'value123');
                    const val = appState.stateInstance.get('test.key');
                    if (val === 'value123') {
                        log('âœ… StateManager Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', 'success');
                        appState.testResults.passed++;
                    }
                } catch (e) {
                    log(`âŒ StateManager Ø®Ø·Ø§: ${e.message}`, 'error');
                    appState.testResults.failed++;
                }
            }
            
            // ØªØ³Øª Context Provider
            if (typeof createContext !== 'undefined') {
                try {
                    const ctx = createContext(eventBus);
                    log('âœ… ContextProvider Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯', 'success');
                    appState.testResults.passed++;
                } catch (e) {
                    log(`âš ï¸ ContextProvider: ${e.message}`, 'warn');
                }
            }
            
            appState.testResults.total = appState.testResults.passed + appState.testResults.failed;
            updateSummary();
            log(`ğŸ“Š ØªØ³Øª Ù‡Ø³ØªÙ‡: ${appState.testResults.passed} Ù…ÙˆÙÙ‚ØŒ ${appState.testResults.failed} Ù†Ø§Ù…ÙˆÙÙ‚`, 'info');
        }
        
        async function runAuthTests() {
            if (appState.loadedFiles.size < 15) {
                log('âš ï¸ Ø§Ø¨ØªØ¯Ø§ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯', 'warn');
                return;
            }
            
            log('ğŸ” Ø´Ø±ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„ Auth...', 'info');
            let authPassed = 0, authFailed = 0;
            
            try {
                // ØªØ³Øª Û±: Auth Utils
                if (typeof window.AuthUtils !== 'undefined') {
                    log('âœ… AuthUtils Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª', 'success');
                    authPassed++;
                }
                
                // ØªØ³Øª Û²: Token Manager
                if (typeof window.TokenManager !== 'undefined') {
                    const tm = new window.TokenManager(appState.stateInstance);
                    log('âœ… TokenManager Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯', 'success');
                    authPassed++;
                }
                
                // ØªØ³Øª Û³: Auth Manager
                if (typeof window.AuthManager !== 'undefined') {
                    appState.authInstance = new window.AuthManager(eventBus, appState.stateInstance);
                    log('âœ… AuthManager Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯', 'success');
                    authPassed++;
                    
                    // ØªØ³Øª Ù…ØªØ¯Ù‡Ø§ÛŒ AuthManager
                    if (typeof appState.authInstance.login === 'function') {
                        log('âœ… Ù…ØªØ¯ login Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª', 'success');
                        authPassed++;
                    }
                    
                    if (typeof appState.authInstance.logout === 'function') {
                        log('âœ… Ù…ØªØ¯ logout Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª', 'success');
                        authPassed++;
                    }
                }
                
                // ØªØ³Øª Û´: Session Service
                if (typeof window.SessionService !== 'undefined') {
                    log('âœ… SessionService Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª', 'success');
                    authPassed++;
                }
                
                // ØªØ³Øª Ûµ: Validator
                if (typeof window.AuthValidator !== 'undefined') {
                    log('âœ… AuthValidator Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª', 'success');
                    authPassed++;
                }
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Auth: ${error.message}`, 'error');
                authFailed++;
            }
            
            log(`ğŸ“Š ØªØ³Øª Auth: ${authPassed} Ù…ÙˆÙÙ‚ØŒ ${authFailed} Ù†Ø§Ù…ÙˆÙÙ‚`, 'info');
            appState.testResults.passed += authPassed;
            appState.testResults.failed += authFailed;
            appState.testResults.total = appState.testResults.passed + appState.testResults.failed;
            updateSummary();
        }
        
        async function testUserFlow() {
            if (!appState.authInstance) {
                log('âš ï¸ Ø§Ø¨ØªØ¯Ø§ AuthManager Ø±Ø§ ØªØ³Øª Ú©Ù†ÛŒØ¯', 'warn');
                return;
            }
            
            log('ğŸ‘¤ ØªØ³Øª Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ø±Ø¨Ø± (Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ)...', 'info');
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù„Ø§Ú¯ÛŒÙ†
            setTimeout(() => {
                log('1. Ú©Ø§Ø±Ø¨Ø± ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯...', 'info');
                eventBus.emit('auth:login:attempt', { email: 'test@vakamova.com' });
            }, 500);
            
            setTimeout(() => {
                log('2. Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯...', 'info');
                eventBus.emit('auth:login:success', { user: { id: 1, name: 'Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª' } });
            }, 1000);
            
            setTimeout(() => {
                log('3. ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒØ´ÙˆØ¯...', 'info');
                if (appState.stateInstance) {
                    appState.stateInstance.set('user.isLoggedIn', true);
                    appState.stateInstance.set('user.data', { id: 1, name: 'Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª' });
                }
            }, 1500);
            
            setTimeout(() => {
                log('4. Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ø±Ø¨Ø± ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯ âœ“', 'success');
                log('âœ… Ø³ÛŒØ³ØªÙ… Auth Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø³Øª', 'success');
            }, 2000);
        }
        
        async function runIntegrationTests() {
            log('ğŸ”— Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· Ø¨ÛŒÙ† Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§...', 'info');
            
            // ØªØ³Øª Ø§Ø±ØªØ¨Ø§Ø· EventBus â†” StateManager â†” Auth
            setTimeout(() => {
                eventBus.emit('integration:test', { module: 'Auth', status: 'testing' });
                
                if (appState.stateInstance) {
                    appState.stateInstance.set('integration.test', 'passed');
                    log('âœ… Ø§Ø±ØªØ¨Ø§Ø· StateManager Ø¨Ø§ EventBus Ø¨Ø±Ù‚Ø±Ø§Ø± Ø§Ø³Øª', 'success');
                }
                
                if (appState.authInstance) {
                    log('âœ… AuthManager Ø¨Ù‡ EventBus Ù…ØªØµÙ„ Ø§Ø³Øª', 'success');
                }
            }, 300);
            
            setTimeout(() => {
                log('âœ… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯', 'success');
            }, 800);
        }
        
        // ==================== UTILITY FUNCTIONS ====================
        function updateFileCard(fileName, status) {
            const categories = { core: 'coreFileList', auth: 'authFileList' };
            const fileInfo = CORE_FILES.find(f => f.name === fileName);
            if (!fileInfo) return;
            
            const container = document.getElementById(categories[fileInfo.category] || 'coreFileList');
            let card = container.querySelector(`[data-file="${fileName}"]`);
            
            if (!card) {
                card = document.createElement('div');
                card.className = 'file-card';
                card.setAttribute('data-file', fileName);
                card.innerHTML = `
                    <div class="file-name">ğŸ“„ ${fileName}</div>
                    <div class="file-type">${fileInfo.type === 'core' ? 'Ù‡Ø³ØªÙ‡' : 
                                          fileInfo.type === 'auth' ? 'Ø§Ø­Ø±Ø§Ø²' : 'Ù¾Ø§ÛŒÙ‡'}</div>
                    <div class="status">â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                `;
                container.appendChild(card);
            }
            
            card.className = `file-card ${status}`;
            card.querySelector('.status').textContent = 
                status === 'loaded' ? 'âœ… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯' : 'âŒ Ø®Ø·Ø§';
        }
        
        function updateProgress() {
            const progress = (appState.loadedFiles.size / CORE_FILES.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('loadedCount').textContent = appState.loadedFiles.size;
        }
        
        function updateSummary() {
            document.getElementById('passedCount').textContent = appState.testResults.passed;
            document.getElementById('failedCount').textContent = appState.testResults.failed;
            document.getElementById('totalTests').textContent = appState.testResults.total;
        }
        
        function clearLogs() {
            document.getElementById('logContainer').innerHTML = '';
            appState.logs = [];
            log('ğŸ—‘ï¸ Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'info');
        }
        
        // ==================== INITIALIZATION ====================
        function initializeFileLists() {
            CORE_FILES.forEach(file => {
                if (file.category === 'auth') {
                    updateFileCard(file.name, 'pending');
                } else {
                    updateFileCard(file.name, 'pending');
                }
            });
        }
        
        window.addEventListener('DOMContentLoaded', () => {
            initializeFileLists();
            log('ğŸŸ¢ ØªØ³ØªØ± Vakamova v2.0 Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª', 'success');
            log(`Ù‡Ø¯Ù: Ø¢Ø²Ù…Ø§ÛŒØ´ ${CORE_FILES.length} ÙØ§ÛŒÙ„ (Ù‡Ø³ØªÙ‡ + Auth)`, 'info');
        });
        
        // Global exports
        window.VakamovaTester = {
            loadAllFiles,
            runBasicTests,
            runAuthTests,
            testUserFlow,
            runIntegrationTests,
            clearLogs,
            getState: () => ({ ...appState })
        };
    </script>
</body>
</html>
