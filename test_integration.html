<!DOCTYPE html>
<html>
<head>
    <title>ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Vakamova</title>
    <style>
        body { font-family: Tahoma; padding: 20px; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ø³ÛŒØ³ØªÙ…</h1>
    <button onclick="runIntegrationTest()">Ø´Ø±ÙˆØ¹ ØªØ³Øª</button>
    <div id="log" class="log"></div>

    <script>
        // Ø§Ø¨ØªØ¯Ø§ Ú©Ù„Ø§Ø³ SessionManager Ø±Ø§ Ø¨Ø§ Ù…ØªØ¯ login ØªØ¹Ø±ÛŒÙ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
        class SessionManager {
            constructor(eventBus, stateManager) {
                this.eventBus = eventBus;
                this.stateManager = stateManager;
            }
            
            async login(credentials) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve({
                            userId: 'user_' + Date.now(),
                            email: credentials.email,
                            token: 'token_' + Math.random().toString(36).substr(2)
                        });
                    }, 500);
                });
            }
            
            async logout() {
                return Promise.resolve();
            }
        }
        
        // Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ Ø¯ÛŒÚ¯Ø±
        class EventBus {
            constructor() { this.listeners = {}; }
            on(event, callback) {
                if (!this.listeners[event]) this.listeners[event] = [];
                this.listeners[event].push(callback);
            }
            emit(event, data) {
                (this.listeners[event] || []).forEach(cb => cb(data));
            }
        }
        
        class StateManager {
            constructor(initialState) {
                this.state = initialState || {};
            }
            dispatch(action) {
                // ØªØºÛŒÛŒØ± state Ø³Ø§Ø¯Ù‡
            }
        }
        
        async function runIntegrationTest() {
            const logEl = document.getElementById('log');
            logEl.innerHTML = '<div>Ø´Ø±ÙˆØ¹ ØªØ³Øª...</div>';
            
            try {
                // 1. Ø³Ø§Ø®Øª Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§
                const eventBus = new EventBus();
                const stateManager = new StateManager({});
                const sessionManager = new SessionManager(eventBus, stateManager);
                
                logEl.innerHTML += '<div class="success">âœ… Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù†Ø¯</div>';
                
                // 2. ØªØ³Øª Ù„Ø§Ú¯ÛŒÙ†
                const session = await sessionManager.login({
                    email: 'test@vakamova.com',
                    password: '123456'
                });
                
                logEl.innerHTML += `<div class="success">âœ… Ù„Ø§Ú¯ÛŒÙ† Ù…ÙˆÙÙ‚: ${session.email}</div>`;
                logEl.innerHTML += `<div class="success">ğŸ‰ ØªØ³Øª ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯!</div>`;
                
            } catch (error) {
                logEl.innerHTML += `<div class="error">âŒ Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
